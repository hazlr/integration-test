var app=angular.module("monApp",["ngRoute"]);app.config(["$routeProvider",function(t){t.when("/",{templateUrl:"partials/home.html",controller:"PostCtrl"}).when("/about",{templateUrl:"partials/about.html"}).when("/blog",{templateUrl:"partials/posts.html",controller:"PostCtrl"}).when("/blog/article:id",{templateUrl:"partials/comments.html",controller:"CommentsCtrl"}).otherwise({redirectTo:"/"})}]),app.factory("PostFactory",["$http","$q","$timeout",function(t,e,o){var n={posts:!1,find:function(){var r=e.defer();return!1!==n.posts?r.resolve(n.posts):t.get("json/posts.json").success(function(t,e){n.posts=t,o(function(){r.resolve(n.posts)},2e3)}).error(function(t,e){r.reject("Impossible de récupérer les articles")}),r.promise},get:function(t){var o=e.defer(),r={};n.find().then(function(e){angular.forEach(e,function(e,o){e.id==t&&(r=e)}),o.resolve(r)},function(t){o.reject(t)});return o.promise},add:function(t){var o=e.defer();return o.resolve(),o.promise}};return n}]),app.directive("ngComment",function(){return{scope:{comment:"="},restrict:"E",templateUrl:"partials/comment.html"}}),app.controller("CommentsCtrl",["$scope","$rootScope","PostFactory","$routeParams",function(t,e,o,n){e.loading=!0,t.newComment={},o.get(n.id).then(function(o){e.loading=!1,t.title=o.name,t.content=o.content,t.comments=o.comments},function(t){alert(t)}),t.addComment=function(){t.comments.push(t.newComment),o.add(t.newComment).then(function(){},function(){alert("Votre message n'a pas pu être enregistré")}),t.newComment={}}}]),app.controller("PostCtrl",["$scope","$rootScope","PostFactory",function(t,e,o){e.loading=!0,t.posts=o.find().then(function(o){e.loading=!1,t.posts=o},function(t){alert(t)})}]);